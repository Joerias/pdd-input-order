var oe=Object.defineProperty;var ae=(c,e,t)=>e in c?oe(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var T=(c,e,t)=>(ae(c,typeof e!="symbol"?e+"":e,t),t),I=(c,e,t)=>{if(!e.has(c))throw TypeError("Cannot "+t)};var B=(c,e,t)=>(I(c,e,"read from private field"),t?t.call(c):e.get(c)),W=(c,e,t)=>{if(e.has(c))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(c):e.set(c,t)},M=(c,e,t,o)=>(I(c,e,"write to private field"),o?o.call(c,t):e.set(c,t),t),A=(c,e,t,o)=>({set _(a){M(c,e,a,t)},get _(){return B(c,e,o)}}),U=(c,e,t)=>(I(c,e,"access private method"),t);import{E as ne,a as H,d as E,r as se,b as k,c as X,o as $,e as D,f as C,w as j,F as y,g as q,t as J,u as R,h as le,n as ee,i as K,j as Y,k as re,l as ce,m as Q,p as ie,q as de}from"./.pnpm.378c6376.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();const n={仅导入txt按钮描述:"导入TXT仅查看",导入txt按钮描述:"导入TXT -> 生成原始EXCEL",导入txt表格标题:"导入TXT数据预览",导入excel按钮描述:"导入已填物流EXCEL -> 生成批量上传EXCEL",导入excel表格标题:"导入EXCEL订单信息预览",生成原始excel文件名:{1:"-第一版-SG",2:"-第二版-SG",3:"-SG"},分解txt表格字段:{订单号:"订单号",商品:"商品",姓名:"姓名",电话:"电话",地址:"地址"},组装excel表格字段:{商品:"商品",数量:"数量",价格:"价格",店铺:"店铺"},组装excel表格版本:{产品12:{1:"第一版",2:"第二版"},产品3:""},组装excel表格封皮:{产品12:"",产品3:{烫印:"烫印",白:"白色",无:"素皮"}},组装excel表格款式:{产品12:{全套:"软皮活页夹+彩色打印纸",书皮:"软皮活页夹"},产品3:{全套:"全套",书皮:"书皮",内页:"内页"}},组装excel表格颜色:{产品12:{绿:"绿",蓝:"蓝",粉:"粉"},产品3:""},组装excel表格价格:{产品12:{全套:48,书皮:15,邮费补价:3},产品3:{全套:39,书皮:14,内页:24,邮费:6,邮费补价:3}},组装excel表格店铺:{1:"店1",2:"店2",3:"店3"},errMsg:{上传txt:"上传txt格式异常"},补价地区:["甘肃","宁夏","青海","内蒙"],补价:3};class ue{constructor(e){T(this,"value");this.value=e}output(e){const t=this.value.getFullYear(),o=this.value.getMonth()+1,a=this.value.getDate();return e?`${t}${e}${o}${e}${a}`:`${t}年${o}月${a}日`}}class he{calc(e){return e.reduce((t,o)=>t+Number(o[n.组装excel表格字段.价格])*o[n.组装excel表格字段.数量],0)}}var P,O,z,te;class pe{constructor(){W(this,z);W(this,P,void 0);W(this,O,void 0)}async documentImport(){try{[A(this,P)._]=await window.showOpenFilePicker();const o=(await(await B(this,P).getFile()).text()).split(`\r
`).filter(i=>i).map(i=>i.replace(/^\s+|\s+$/g,""));let a=[];o.forEach((i,r)=>{i==="="&&a.push(r)});const s=U(this,z,te).call(this,a,o,Object.keys(n.分解txt表格字段).length);if(s){ne.error(`${n.errMsg.上传txt} ${s}`);return}return o}catch{}}async generate(e){const t=e.filter(l=>l!=="="),o=[],a=Object.keys(n.分解txt表格字段).length;for(let l=0;l<t.length;l+=a){const u={};t.slice(l,l+a).forEach((p,v)=>{switch(v){case 0:u[n.分解txt表格字段.订单号]=p;break;case 1:u[n.分解txt表格字段.商品]=p;break;case 2:u[n.分解txt表格字段.姓名]=p;break;case 3:u[n.分解txt表格字段.电话]=p;break;case 4:u[n.分解txt表格字段.地址]=p;const L=e.findIndex(S=>S===p),_=e.slice(0,L);let x=_.indexOf("="),f=1;for(;x!==-1;)f++,x=_.indexOf("=",x+1);u.shop=f;break}}),o.push(u)}const s=[],i=[],r=[],d=[],h=[],b=[],m=[],F=[],g=[];o.forEach(l=>{const u=l.商品.indexOf("#")!==-1?l.商品.substring(l.商品.indexOf("#")+1,l.商品.indexOf("#")+2)*1:["升级款","高级版"].some(G=>l.商品.includes(G))?2:1,p=l.商品.indexOf("!")!==-1?l.商品.substring(l.商品.indexOf("!")+1,l.商品.indexOf("!")+2)*1:1;let v=!1;n.补价地区.find(G=>{l.地址.includes(G)&&(v=!0)});const L=n.组装excel表格店铺[l.shop];let _,x,f,S,N;switch(u){case 1:_=n.组装excel表格版本.产品12[1],x=n.组装excel表格封皮.产品12,f=l.商品.includes("+软皮活页夹")?n.组装excel表格款式.产品12.全套:n.组装excel表格款式.产品12.书皮,S=l.商品.includes("绿")?n.组装excel表格颜色.产品12.绿:l.商品.includes("粉")?n.组装excel表格颜色.产品12.粉:l.商品.includes("蓝")?n.组装excel表格颜色.产品12.蓝:"异常",N=(f===n.组装excel表格款式.产品12.全套?n.组装excel表格价格.产品12.全套:n.组装excel表格价格.产品12.书皮)+(v?n.组装excel表格价格.产品12.邮费补价:0);break;case 2:_=n.组装excel表格版本.产品12[2],x=n.组装excel表格封皮.产品12,f=l.商品.includes("+软皮活页夹")?n.组装excel表格款式.产品12.全套:n.组装excel表格款式.产品12.书皮,S=l.商品.includes("绿")?n.组装excel表格颜色.产品12.绿:l.商品.includes("粉")?n.组装excel表格颜色.产品12.粉:l.商品.includes("蓝")?n.组装excel表格颜色.产品12.蓝:"异常",N=(f===n.组装excel表格款式.产品12.全套?n.组装excel表格价格.产品12.全套:n.组装excel表格价格.产品12.书皮)+(v?n.组装excel表格价格.产品12.邮费补价:0);break;case 3:_=n.组装excel表格版本.产品3,x=l.商品.includes("凹印")?n.组装excel表格封皮.产品3.烫印:l.商品.includes("uv印")?n.组装excel表格封皮.产品3.白:l.商品.includes("无印")?n.组装excel表格封皮.产品3.无:"",f=l.商品.includes("+彩页内页")?n.组装excel表格款式.产品3.全套:l.商品.includes("无内页")?n.组装excel表格款式.产品3.书皮:n.组装excel表格款式.产品3.内页,S=n.组装excel表格颜色.产品3,N=(f===n.组装excel表格款式.产品3.全套?n.组装excel表格价格.产品3.全套:f===n.组装excel表格款式.产品3.书皮?n.组装excel表格价格.产品3.书皮:n.组装excel表格价格.产品3.内页)+n.组装excel表格价格.产品3.邮费+(v?n.组装excel表格价格.产品3.邮费补价:0);break}const w={物流单号:"",[n.分解txt表格字段.姓名]:l.姓名,[n.分解txt表格字段.电话]:l.电话,[n.分解txt表格字段.地址]:l.地址,[n.组装excel表格字段.商品]:`${_} ${x} ${f} ${S}`,[n.组装excel表格字段.数量]:p,[n.组装excel表格字段.价格]:N,[n.分解txt表格字段.订单号]:l.订单号,[n.组装excel表格字段.店铺]:L};switch(u){case 1:if(f===n.组装excel表格款式.产品12.全套)switch(S){case n.组装excel表格颜色.产品12.绿:i.push(w);break;case n.组装excel表格颜色.产品12.粉:r.push(w);break;case n.组装excel表格颜色.产品12.蓝:d.push(w);break}else s.push(w);break;case 2:if(f===n.组装excel表格款式.产品12.全套)switch(S){case n.组装excel表格颜色.产品12.绿:b.push(w);break;case n.组装excel表格颜色.产品12.粉:m.push(w);break;case n.组装excel表格颜色.产品12.蓝:F.push(w);break}else h.push(w);break;case 3:g.push(w);break}}),M(this,O,{pd1Cover:s,pd1SuitGreen:i,pd1SuitPink:r,pd1SuitBlue:d,pd2Cover:h,pd2SuitGreen:b,pd2SuitPink:m,pd2SuitBlue:F,pd3:g})}getCollectData(){const{pd1Cover:e,pd1SuitGreen:t,pd1SuitPink:o,pd1SuitBlue:a,pd2Cover:s,pd2SuitGreen:i,pd2SuitPink:r,pd2SuitBlue:d,pd3:h}=B(this,O);return[...e,...t,...o,...a,...s,...i,...r,...d,...h]}getShopsData(){const{pd1Cover:e,pd1SuitGreen:t,pd1SuitPink:o,pd1SuitBlue:a,pd2Cover:s,pd2SuitGreen:i,pd2SuitPink:r,pd2SuitBlue:d,pd3:h}=B(this,O);return{1:[...e,...t,...o,...a],2:[...s,...i,...r,...d],3:[...h]}}}P=new WeakMap,O=new WeakMap,z=new WeakSet,te=function(e,t,o){if(e.length===0){if(t.length%o!==0)return"当前数据仅为默认店铺，且录入数据条目不成对"}else for(let a=0;a<=e.length;a++)switch(a){case 0:if(e[a]%o!==0)return"当前数据为多组店铺，其中第1组数据条目不成对";break;case e.length:if((t.length-e[a-1]-1)%o!==0)return"当前数据为多组店铺，其中最后一组数据条目不成对";break;default:if((e[a]-e[a-1]-1)%o!==0)return`当前数据为多组店铺，其中第${a+1}组数据条目不成对`;break}};class xe{constructor(e){T(this,"blob");T(this,"worksheet");T(this,"header");this.blob=e,this.worksheet=void 0,this.header=[]}readFile(){return new Promise((e,t)=>{let o=new FileReader;this.blob?(o.readAsArrayBuffer(this.blob),o.onload=a=>{e(a.target.result)}):t("上传文件异常!")})}async getWorkBook(){let e=await this.readFile();return await new H.Workbook().xlsx.load(e)}async getWorkSheet(e=0){return(await this.getWorkBook()).getWorksheet(e)}async importExcel(e){const{i:t=1,header:o}=e,s=(await this.getWorkBook()).getWorksheet(t),i=[];return s.getSheetValues().filter(r=>!!(r!=null&&r.length)).forEach(r=>{r.shift();let d={};r.forEach((h,b)=>{d[o[b]]=h}),i.push(d)}),i}async exportExcel(e){const{name:t,sheetName:o="Sheet1",title:a="",titleStyle:s,subTitle:i="",subTitleStyle:r,header:d,customHeader:h,headerStyle:b,data:m,cellStyle:F,mergeList:g=[],password:l=""}=e,u=new H.Workbook;u.creator="",u.created=new Date,this.worksheet=u.addWorksheet(o,{properties:{tabColor:{argb:"FF00FF00"}}}),this.header=d??Object.keys(m[0]);let p=1;a&&p++,i&&p++,this.setCells(m,h,F),this.getTitle(a,s),this.getSubTitle(i,r),this.setHeaderStyle(p,m,b),this.handleDealExcel(l,g,p),u.xlsx.writeBuffer().then(v=>{const L=new ue(new Date);let _=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const x=document.createElement("a");x.href=URL.createObjectURL(_),x.download=L.output("-")+t+".xlsx",document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(x.href)})}merge(e,t){const o=[];return e.forEach(a=>{o.push(...t.map(s=>({...s,...a})))}),o}setCells(e,t,o){var s,i;const a=[];this.header.forEach((r,d)=>{a.push({header:t?t[d]:r,key:r,width:o.singleWidth?o.singleWidth[d]:(o==null?void 0:o.width)||20})}),this.worksheet.columns=a,(s=this.worksheet)==null||s.addRows(e),(i=this.worksheet)==null||i.eachRow({includeEmpty:!0},(r,d)=>{r.height=(o==null?void 0:o.height)||20}),this.worksheet.columns.forEach(r=>{r.font=(o==null?void 0:o.font)||{name:"微软雅黑"},r.alignment=(o==null?void 0:o.alignment)||{vertical:"middle",horizontal:"left",wrapText:!0}})}getTitle(e,t){var o,a;if(e){(o=this.worksheet)==null||o.spliceRows(1,0,[e]),(a=this.worksheet)==null||a.mergeCells(1,1,1,this.header.length);const s=this.worksheet.getRow(1);s.height=(t==null?void 0:t.height)||40,s.font=(t==null?void 0:t.font)||{name:"微软雅黑",size:20,bold:!0},s.fill=(t==null?void 0:t.fill)||{bgColor:{argb:"FFFFFF00"},type:"pattern",pattern:"none"},s.alignment=(t==null?void 0:t.alignment)||{horizontal:"center",vertical:"middle"}}}getSubTitle(e,t){var o,a;if(e){(o=this.worksheet)==null||o.spliceRows(2,0,[e]),(a=this.worksheet)==null||a.mergeCells(2,1,2,this.header.length);const s=this.worksheet.getRow(2);s.height=(t==null?void 0:t.height)||20,s.font=(t==null?void 0:t.font)||{name:"微软雅黑",size:14},s.fill=(t==null?void 0:t.fill)||{bgColor:{argb:"FFFFFF00"},type:"pattern",pattern:"none"},s.alignment=(t==null?void 0:t.alignment)||{horizontal:"right",vertical:"middle"}}}setHeaderStyle(e,t,o){this.worksheet.autoFilter={from:{row:e,column:1},to:{row:t.length,column:this.header.length}};let a=this.worksheet.getRow(e);a.height=o==null?void 0:o.height,a==null||a.eachCell(s=>{s.fill=(o==null?void 0:o.fill)||{type:"pattern",pattern:"solid",fgColor:{argb:"dde0e7"}},s.font=(o==null?void 0:o.font)||{name:"微软雅黑"}})}handleDealExcel(e,t,o){var a;e&&((a=this.worksheet)==null||a.protect(e,{autoFilter:!0,selectLockedCells:!1})),t.forEach(s=>{var d;const i=s.startRow+o,r=s.endRow+o;(d=this.worksheet)==null||d.mergeCells(i,s.startColumn,r,s.endColumn)}),this.worksheet.views=[{state:"frozen",xSplit:0,ySplit:o}]}}const fe=E({name:"import-txt"}),ge=E({...fe,emits:["transitionList"],setup(c,{emit:e}){const t=new pe,o=new he,a=new xe,s=se([]),i=k([]),r=k({}),d=k(0),h=k(!1),b=k(!1),m=async g=>{F(g,!0);try{const l=await t.documentImport();if(await t.generate(l),i.value=t.getCollectData(),d.value=o.calc(i.value),e("transitionList",i.value,d.value,g),g===2){r.value=t.getShopsData();for(const u in r.value)r.value[u].length>0&&a.exportExcel({name:n.生成原始excel文件名[u],data:r.value[u],cellStyle:{singleWidth:[20,15,15,70,40,5,5,30,10]},mergeList:s})}}catch(l){console.log(l)}finally{F(g,!1)}},F=(g,l)=>{g===1?h.value=l:b.value=l};return(g,l)=>{const u=X("el-button");return $(),D(y,null,[C(u,{size:"large",type:"success",plain:"",loading:h.value,onClick:l[0]||(l[0]=p=>m(1))},{default:j(()=>[q(J(R(n).仅导入txt按钮描述),1)]),_:1},8,["loading"]),C(u,{size:"large",type:"warning",plain:"",loading:b.value,onClick:l[1]||(l[1]=p=>m(2))},{default:j(()=>[q(J(R(n).导入txt按钮描述),1)]),_:1},8,["loading"])],64)}}}),be=E({name:"tables"}),me=E({...be,props:{data:null,label:null,total:{default:0},borderColor:{default:"blue"}},setup(c){const e=c,t=le(()=>e.total?`${e.label}  总价:${e.total}`:e.label);return(o,a)=>{const s=X("el-table-column"),i=X("el-table");return e.data.length!==0?($(),D("div",{key:0,class:ee(["box mt10",e.borderColor])},[C(i,{data:e.data,border:"",stripe:""},{default:j(()=>[C(s,{align:"center",label:R(t)},{default:j(()=>[e.data.length>3?($(),Y(s,{key:0,type:"index",width:"40",align:"center"})):K("",!0),($(!0),D(y,null,re(Object.keys(e.data[0]),(r,d)=>($(),Y(s,{prop:r,label:r,key:d},null,8,["prop","label"]))),128))]),_:1},8,["label"])]),_:1},8,["data"])],2)):K("",!0)}}});const V=(c,e)=>{const t=c.__vccOpts||c;for(const[o,a]of e)t[o]=a;return t},Z=V(me,[["__scopeId","data-v-a8ccdb85"]]),_e={class:"box mt20"},we=ce('<div class="title" data-v-7397d6e8>格式示例</div><div class="con" data-v-7397d6e8><p class="split" data-v-7397d6e8>=</p><p class="split" data-v-7397d6e8>=</p><p class="order-no" data-v-7397d6e8>230601-065981684600888</p><p class="sku" data-v-7397d6e8>uv印+彩页内页+赠送资料<span class="red" data-v-7397d6e8>!</span>2<span class="red" data-v-7397d6e8>#</span>2</p><p class="name" data-v-7397d6e8>孙权(9740)[4361]</p><p class="phone" data-v-7397d6e8>17288888888</p><p class="add" data-v-7397d6e8>安徽省 合肥市 张辽对面(9740)[4361]</p></div>',2),ke=[we],ve=E({name:"txt-demo"}),Se=E({...ve,setup(c){return(e,t)=>($(),D("div",_e,ke))}});const Ce=V(Se,[["__scopeId","data-v-7397d6e8"]]),Ee={class:"btns"},Fe={class:"w96per mauto"},$e=E({name:"app"}),Oe=E({...$e,setup(c){const e=k([]),t=k(0),o=k(""),a=(i,r,d)=>{e.value=i,t.value=r,o.value=d===1?"green":"yellow"},s=k([]);return(i,r)=>($(),D("div",{class:ee(["container",{data:e.value.length>0}])},[Q("div",Ee,[C(ge,{onTransitionList:r[0]||(r[0]=(d,h,b)=>a(d,h,b))})]),Q("div",Fe,[C(Z,{data:e.value,total:t.value,label:R(n).导入txt表格标题,borderColor:o.value},null,8,["data","total","label","borderColor"]),C(Z,{data:s.value,label:R(n).导入excel按钮描述},null,8,["data","label"])]),C(Ce)],2))}});const Le=V(Oe,[["__scopeId","data-v-8a2f98d1"]]),Te=ie(Le);Te.use(de).mount("#app");
